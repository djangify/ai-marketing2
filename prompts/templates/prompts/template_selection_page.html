py-2 px-3 focus:outline-none focus:ring-[#9810fa] focus:border-[#9810fa]">
                            <option value="" disabled selected>Select a Template</option>
                            {% for template in templates %}
                                <option value="{{ template.id }}">{{ template.title }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    
                    <div class="flex justify-end space-x-3">
                        <a href="{% url 'projects:project_detail' project_id=project.id %}?tab=prompts" 
                           class="inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 px-4 py-2">
                            Cancel
                        </a>
                        <button type="submit" 
                                class="btn-main inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 bg-[#9810fa] text-white shadow-sm hover:bg-[#9810fa]/90 h-9 px-4 py-2">
                            Import Template
                        </button>
                    </div>
                {% else %}
                    <div class="text-center py-6">
                        <p class="mb-4">You do not have any templates with existing prompts.</p>
                        <a href="{% url 'content_templates:template_list' %}" class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 bg-[#9810fa] text-white shadow hover:bg-[#9810fa]/90 h-9 px-4 py-2">
                            Create Template
                        </a>
                    </div>
                {% endif %}
            </form>
        </div>
        
        <!-- Generated Prompts Tab Content -->
        <div id="content-prompts" class="tab-content hidden">
            <p class="text-gray-600 mb-6">Choose a generated prompt to add to your project</p>
            
            <form method="post" action="{% url 'prompts:import_generated_prompt' project_id=project.id %}" class="space-y-6" id="prompt-form">
                {% csrf_token %}
                
                {% if generated_prompts %}
                    <div class="space-y-2">
                        <label for="prompt-select" class="block text-sm font-medium text-gray-700">Select Generated Prompt</label>
                        <select id="prompt-select" name="promptId" class="w-full bg-white border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-[#9810fa] focus:border-[#9810fa]">
                            <option value="" disabled selected>Select a Generated Prompt</option>
                            {% for prompt in generated_prompts %}
                                <option value="{{ prompt.id }}">{{ prompt.name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    
                    <div class="flex justify-end space-x-3">
                        <a href="{% url 'projects:project_detail' project_id=project.id %}?tab=prompts" 
                           class="inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 px-4 py-2">
                            Cancel
                        </a>
                        <button type="submit" 
                                class="btn-main inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 bg-[#9810fa] text-white shadow-sm hover:bg-[#9810fa]/90 h-9 px-4 py-2">
                            Import Prompt
                        </button>
                    </div>
                {% else %}
                    <div class="text-center py-6">
                        <p class="mb-4">You do not have any generated prompts.</p>
                        <a href="{% url 'prompt_generator:generator' %}" class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 bg-[#9810fa] text-white shadow hover:bg-[#9810fa]/90 h-9 px-4 py-2">
                            Generate Prompts
                        </a>
                    </div>
                {% endif %}
            </form>
        </div>
    </div>
</div>
<script>
    // Execute immediately when loaded
    (function() {
      console.log("Modal tab script loaded");
      
      // Get tab elements
      const templatesTab = document.getElementById('tab-templates');
      const promptsTab = document.getElementById('tab-prompts');
      
      if (templatesTab && promptsTab) {
        console.log("Found tab elements, attaching event listeners");
        
        // Templates tab click handler
        templatesTab.onclick = function(e) {
          e.preventDefault();
          console.log("Templates tab clicked");
          
          // Show templates, hide prompts
          document.getElementById('content-templates').style.display = 'block';
          document.getElementById('content-prompts').style.display = 'none';
          
          // Update active styles
          templatesTab.className = 'tab-button border-[#9810fa] text-[#9810fa] border-b-2 py-2 px-1 text-sm font-medium';
          promptsTab.className = 'tab-button border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 border-b-2 py-2 px-1 text-sm font-medium';
        };
        
        // Prompts tab click handler
        promptsTab.onclick = function(e) {
          e.preventDefault();
          console.log("Prompts tab clicked");
          
          // Show prompts, hide templates
          document.getElementById('content-templates').style.display = 'none';
          document.getElementById('content-prompts').style.display = 'block';
          
          // Update active styles
          promptsTab.className = 'tab-button border-[#9810fa] text-[#9810fa] border-b-2 py-2 px-1 text-sm font-medium';
          templatesTab.className = 'tab-button border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 border-b-2 py-2 px-1 text-sm font-medium';
        };
        
        // Fix for the import button
        const importButton = document.getElementById('confirm-import-button');
        if (importButton) {
          importButton.onclick = function() {
            // Determine active tab
            const isPromptTab = promptsTab.className.includes('border-[#9810fa]');
            let selectedId, endpoint, payload;
            
            if (isPromptTab) {
              // Get selected prompt
              const promptSelect = document.getElementById('prompt-select');
              if (!promptSelect || !promptSelect.value) {
                alert("Please select a generated prompt");
                return;
              }
              selectedId = promptSelect.value;
              endpoint = '/prompts/{{ project.id }}/import-generated-prompt/';
              payload = { promptId: selectedId };
            } else {
              // Get selected template
              const templateSelect = document.getElementById('template-select');
              if (!templateSelect || !templateSelect.value) {
                alert("Please select a template");
                return;
              }
              selectedId = templateSelect.value;
              endpoint = '/prompts/{{ project.id }}/import-template/';
              payload = { templateId: selectedId };
            }
            
            // Show loading state
            const originalText = this.innerHTML;
            this.innerHTML = '<svg class="animate-spin h-4 w-4 mr-2 inline-block" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Importing...';
            this.disabled = true;
            
            // Get CSRF token
            const csrfToken = document.querySelector('input[name="csrfmiddlewaretoken"]').value;
            
            // Send request
            fetch(endpoint, {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': csrfToken,
                'X-Requested-With': 'XMLHttpRequest'
              },
              body: JSON.stringify(payload)
            })
            .then(response => {
              console.log("Response status:", response.status);
              return response.json().then(data => {
                if (!response.ok) {
                  throw { 
                    message: data.message || "Unknown error", 
                    status: response.status
                  };
                }
                return data;
              });
            })
            .then(data => {
              console.log("Import successful:", data);
              window.location.href = '/projects/{{ project.id }}/?tab=prompts';
            })
            .catch(error => {
              console.error("Import error:", error);
              alert(error.message || "Error importing content");
              
              // Reset button
              this.innerHTML = originalText;
              this.disabled = false;
            });
          };
        } else {
          console.error("Import button not found");
        }
      } else {
        console.error("Tab elements not found");
      }
    })();
  </script>